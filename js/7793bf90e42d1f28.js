!function(){if(void 0===window.ometria||"function"!=typeof ometria.init){void 0!==window.ometria&&(window.ometria.init=function(){});var e=navigator.cookieEnabled||"cookie"in document&&(0<document.cookie.length||-1<(document.cookie="test").indexOf.call(document.cookie,"test"));if(e&&(!window.navigator||"preview"!==window.navigator.loadPurpose)){"#om_debug"==window.location.hash&&D("OMdebug","1",1),"#om_debug=off"==window.location.hash&&D("OMdebug","0",-1);function d(e){return p.namespace?p.namespace+e:e}var o,a,t="1"==q("OMdebug"),c=(_log=[],function(e){_log.push(e)}),N=function(e,t){_log.push([e,t])},m=function(e){_log.push(e),t&&console.log(["OMETRIA",e])},p={key:"7793bf90e42d1f28",endpoint:"//trk.ometria.com/track/",plugins:["overlays_(remember to create overlay custom field)","shopify"],callback_timeout:250,cookie_expire_days:365,session_timeout:1800,api_version:3,payment_domains:["worldpay","paypal","myshopify","pay.shopify.com"],cookie_domain:null,remove_domain_prefixes:["www.","secure."],page_types:[],external_campaign_plugins:[],extra_plugin_code:"",cart_deeplink_url:null},l=(p.endpoint="https:"+p.endpoint,-1<window.location.host.indexOf("localhost")&&(p.endpoint="http://trk.ometria.localhost/track/"),t&&(o=null,a=[],c=function(e){Y(e),console.log(["OMETRIA",e,f])},N=function(e,t){var n,o;Y((n=t,o="Event: "+e,"pageview"==e&&(o+=" ("+n.type,"product"==n.type&&(o+=" #"+n.pid),o+=")"),"transaction"==e&&(o+=" ("+n.tid+")"),"checkout"==e&&(o+=" ("+n.stage+")"),o),t),console.log(["OMETRIA","Sending event",e,t,f])},m=function(e){console.log(["OMETRIA",e])}),{_keyStr:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=",encode:function(e){var t,n,o,i,a,r,c="",s=0;for(e=l._utf8_encode(e);s<e.length;)o=(t=e.charCodeAt(s++))>>2,i=(3&t)<<4|(t=e.charCodeAt(s++))>>4,a=(15&t)<<2|(n=e.charCodeAt(s++))>>6,r=63&n,isNaN(t)?a=r=64:isNaN(n)&&(r=64),c=c+l._keyStr.charAt(o)+l._keyStr.charAt(i)+l._keyStr.charAt(a)+l._keyStr.charAt(r);return c},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var o=e.charCodeAt(n);t+=o<128?String.fromCharCode(o):"\\u"+("0000"+o.toString(16)).slice(-4)}return t}}),s=(M.prototype.get=function(e,t){return this.data.contains(e)?this.data.get(e):t},M.prototype.getInt=function(e,t){return parseInt(this.get(e,t))},M.prototype.appendText=function(e,t,n){n=n||"",this.changed=!0;var o=this.data.get(e)||"";o&&(o+=n),o+=t,this.data.set(e,t),this.saveSoon()},M.prototype.set=function(e,t){this.changed=!0,this.data.set(e,t),this.saveSoon()},M.prototype.saveSoon=function(e,t){var n=this;this.saveto&&clearTimeout(this.saveto),this.saveto=setTimeout(function(){n.saveto=null,n.save()},5)},M.prototype.inc=function(e,t){var n=this.getInt(e)||0;this.set(e,n+(t=t||1))},M.prototype.load=function(){var e=q(this.name);e&&(this.existed=!0,this.data=X(e))},M.prototype.save=function(){this.saveto&&(clearTimeout(this.saveto),this.saveto=null),D(this.name,Q(this.data.toObject()),this.life,this.domain),this.checkforDoubleCookie(),this.changed=!1},M.prototype.checkforDoubleCookie=function(){var e=document.cookie.indexOf(this.name+"=");-1!=e&&-1!=document.cookie.indexOf(this.name+"=",e+1)&&(e=location.hostname,this.domain!=e)&&this.domain!="."+e&&(c("Erase cookie"),P(this.name,e),P(this.name,""))},M.prototype.saveIfDirty=function(){this.changed&&this.save()},[]);A.prototype.setData=function(e){for(var t in e)this[t]=e[t]},A.prototype.setProperties=function(e){this.p=e},A.prototype.addLineItem=function(e,t,n,o,i){var a;n=Z(n),a=t,t=Math.floor(Z(a)),"object"==typeof o&&(i=o,o=null),this.lis.push({pid:e,vid:o,q:t,tot:n,p:i||{}}),this.size+=t},A.prototype.setTotal=function(e,t){e=Z(e),this.total=e,this.cur=t},A.prototype.setId=function(e){this.id=e},A.prototype.setUrl=function(e){this.url=e},A.prototype.setURL=function(e){this.url=e},A.prototype.signature=function(){return this.size+"|"+this.total};try{document.body.addEventListener("change",function(e){try{var t=e.target;"email"==t.type&&t.id.startsWith("bx-")&&ometria&&L(t.value)&&(ometria.identify(t.value),R("bx:signup",{}))}catch(e){}},!1)}catch(e){m(e)}void 0!==p.cookie_domain&&p.cookie_domain||(p.cookie_domain="."+I(T()));var f={},u={},g=null,y=new M("ometria",365,p.cookie_domain);t&&(f.debug=1),e=q("OMuser"),r=function(){var e=q("OMud");try{return e?JSON.parse(e):null}catch(e){return null}}(),e&&(y.existed=!0,e=e.split("|"),y.set("cid",e[0]),y.set("sid",e[1]),y.set("slt",parseInt(e[2])),y.set("nses",parseInt(e[3])),y.set("src",(e[4]||"").replace(/\*/g,"|")),P("OMuser")),r&&(y.existed=!0,y.set("uiid",r.id),P("OMud")),y.saveIfDirty(),f.cor=C(16),y.get("cid")||(c("NEW COOKIE ID"),ne()),f.cid=y.get("cid"),f.uiid=y.get("uiid"),f.uiid?c("Identified: "+f.uiid):c("Not identified"),f.dtouch="ontouchstart"in window||"onmsgesturechange"in window?1:0,f.dsize=screen.width+"x"+screen.height,f.enc=document.characterSet||document.charset;var U,n,e=T(),r=T(document.referrer),h=(r==e&&(r=null),I(e)),v=I(r),w=X(window.location.search),j=(w.contains("om_user")?window.setTimeout(function(){ometria.identify(w.get("om_user")),window.history&&window.history.replaceState&&window.history.replaceState({},"",location.href.replace(/om_user=[^&]+&?/,""))},100):w.contains("om_profile")?window.setTimeout(function(){ometria.identify("omid:"+w.get("om_profile")),window.history&&window.history.replaceState&&window.history.replaceState({},"",location.href.replace(/om_profile=[^&]+&?/,""))},100):w.contains("kmi")&&window.setTimeout(function(){ometria.identify(w.get("kmi"))},100),function(e){return e.contains("om_campaign")?e.get("om_campaign"):""}(w)),B=Math.floor((new Date).getTime()/1e3),_=y.getInt("slt",0),H=!1,b=!1,k=!1;if((_=B-_)>=p.session_timeout&&(b=!0),r&&h!=v){H=!0,f.rurl=r,600<_&&(b=!0),w.contains("utm_nooverride")&&(b=!1);for(var x=0;x<p.payment_domains.length;x++)-1<v.indexOf(p.payment_domains[x])&&(b=!1)}r&&h==v&&_<1.95*p.session_timeout&&(b=!1),_<=600&&(b=!1),(b=f.cnew?!0:b)?(f.snew=1,h=p.key,U=C(12),n=(new Date).getTime()/1e3-1388534400,n=Math.floor(n/2592e3),h=h.substring(0,3)+h.substring(h.length-3),y.set("sid",h+n+U),c("NEW SESSION: "+y.get("sid")),y.inc("nses"),y.set("npv",0),y.set("tids",""),r&&!H&&!f.cnew||(k=!0)):c("EXISTING SESSION: "+y.get("sid")),(k=j?!0:k)&&((h=ee(e,r))||3<=function(e){return e&&7<=(e=e.split("|")).length?(e=parseInt(e[6]),te()-e):null}(y.get("src"))?(c("SOURCE CHANGED: "+y.get("sid")),y.set("ecamp",j),y.set("src",h),f.cnew&&y.set("osrc",h)):c("SOURCE CONTINUED: "+y.get("sid"))),y.set("slt",B),f.tlast=_,f.sid=y.get("sid"),f.nses=y.getInt("nses"),f.src=y.get("src"),f.osrc=y.get("osrc"),f.osts=y.get("osts"),f.ecamp=y.get("ecamp",""),f.tids=y.get("tids"),f.url=T(),y.save();var z=!1,F=f.nses&&f.nses<=1,G=null,S={},E=[];E.push(function(){var o=(f||{}).uiid;if(!window.ometria_overlays_enabled){window.ometria_overlays_enabled=!0;var e,t,n,i,S=this;S.a11yImageHasLoaded=!1,S.focusOnLoad=function(){setTimeout(function(){if(S.a11yImageHasLoaded){var e=document.getElementById("om_overlay_a11y_img");if(e)return void e.focus()}e=document.getElementById("om_overlay_email_input");e&&e.focus()},500)},S.cleanup=function(){var e=(S||{}).onKeyUp,e=(e&&document.removeEventListener("keyup",e),(S||{}).onMouseOut),e=(e&&document.removeEventListener("mouseout",e),(S||{}).onTouchStart),e=(e&&document.removeEventListener("touchstart",e),(S||{}).onScroll);e&&document.removeEventListener("scroll",e)};try{S.baseUrl="https://cdn.ometria.com/";var a=((window||{}).location||{}).hash,r=("#om_overlay_debug"!==a&&"#om_overlays_debug"!==a||(S.baseUrl="https://cdn-ometria-com.s3-eu-west-1.amazonaws.com/"),S.isFetchSupported=function(){return"fetch"in window},S.isURLSearchParamsSupported=function(){return"URLSearchParams"in window},S.isPromiseSupported=function(){return"Promise"in window},S.isLocalStorageSupported=function(){return"localStorage"in window},S.isBrowserSupported=function(){return S.isFetchSupported()&&S.isPromiseSupported()&&S.isLocalStorageSupported()&&S.isURLSearchParamsSupported()},S.getLocalStorageKey=function(e){return"om:overlays:".concat(e)},{NUMBER_OF_DISPLAYS:S.getLocalStorageKey("number_of_displays"),HAS_REJECTED:S.getLocalStorageKey("has_rejected"),LAST_DISPLAYED_TIME:S.getLocalStorageKey("last_displayed_time")}),c=(S.incrementNumberOfDisplays=function(){var e=localStorage.getItem(r.NUMBER_OF_DISPLAYS),e=null===e?0:parseInt(e);isNaN(e)&&(e=0);try{localStorage.setItem(r.NUMBER_OF_DISPLAYS,(e+1).toString())}catch(e){}},S.getNumberOfDisplays=function(){var e=localStorage.getItem(r.NUMBER_OF_DISPLAYS);return null===e?0:parseInt(e)},S.setHasRejected=function(){try{localStorage.setItem(r.HAS_REJECTED,"true")}catch(e){}},S.getHasRejected=function(){return"true"===localStorage.getItem(r.HAS_REJECTED)},S.setLastDisplayedTime=function(){try{localStorage.setItem(r.LAST_DISPLAYED_TIME,(new Date).toISOString())}catch(e){}},S.getLastDisplayedTime=function(){return localStorage.getItem(r.LAST_DISPLAYED_TIME)},S.isNowGreaterThanLastDisplayedTimePlusADay=function(){var e=new Date,t=S.getLastDisplayedTime();return null===t||((t=new Date(t)).setDate(t.getDate()+1),t<e)},"".concat(S.baseUrl,"overlays/").concat(p.key,"/data.json"));function E(e,t){for(var n in t)e.setAttribute(n,t[n])}return S.getOverlaySettings=function(){return fetch(c).then(function(e){return 200!==e.status?Promise.reject("Could not fetch overlay settings."):e.json()},function(e){return Promise.reject("Could not fetch overlay settings.")})},S.signup=function(e){return fetch("https://api.ometria.com/overlays/signup",{body:e,headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"post"}).then(function(e){return 202!==e.status?Promise.reject("Could not sign you up!"):Promise.resolve(!0)},function(e){return Promise.reject(!1)})},S.createBackdrop=function(e){var t=document.createElement("div");return t.setAttribute("data-testid","om-overlays-backdrop"),t.style.cssText='font-family:"'.concat(e,'", sans-serif;position: fixed;top: 0;left: 0;width: 100%;height: 100%;background-color: rgba(0,0,0,0.5);z-index: 2147483647;"'),t},S.createContentContainer=function(e,t,n,o){t=S.createElement("div","min-width:300px;position: fixed;top:50%;left:50%;box-sizing:border-box;transform: translate(-50%,-50%);max-width:calc(100% - 80px);max-height:calc(100% - 80px);width: 500px; height: 350px;background-color: ".concat(t,';background-size: cover;background-position:center;background-repeat: no-repeat;background-image: url("').concat(n,'");padding:16px;display:flex;flex-direction:column; justify-content: space-between;z-index:101;overflow:auto;'),e);return void 0!==o&&o&&(S.createImg(n,o,"position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); border: 0;",t,"om_overlay_a11y_img",0),S.a11yImageHasLoaded=!0),t},S.createTopSection=function(e,t){return S.createElement("div","display: flex;flex-direction:column;overflow:auto;max-height: calc(100vh - 150px);height:100%;justify-content:center;".concat(t),e)},S.createBottomSection=function(e){return S.createElement("div","display: block;flex-direction:column;align-items:space-between;",e)},S.createCloseButton=function(e){var t=S.createElement("div",'display:block;position: absolute;right: 30px;top: 30px;cursor: pointer;height: 22px;width: 22px;background-image: url("'.concat(S.baseUrl,'overlays/assets/close.png");'),e);return t.onkeypress=function(e){13==e.keyCode&&t.click()},E(t,{"data-testid":"om-overlays-close",tabIndex:0}),t},S.createHeader=function(e,t,n,o,i){n=document.createTextNode(n),t=S.createElement("div","color: ".concat(t,";font-size:",o,"px; line-height:",i,"px;display: -webkit-box;-webkit-box-orient: vertical;align-self: center;font-weight: bold;margin-bottom: 15px;width: 100%;word-wrap:break-word;text-overflow: ellipsis;overflow:hidden;"),e);return t.appendChild(n),t},S.createBody=function(e,t,n,o,i,a){t=S.createElement("div","color: ".concat(t,";font-size:",i,"px; line-height:",a,"px;display: -webkit-box;-webkit-line-clamp: ").concat(o,";-webkit-box-orient: vertical;align-self: center;margin-bottom: 30px;width: 100%;word-wrap:break-word;text-overflow: ellipsis;overflow:hidden;"),e),i=document.createTextNode(n);return t.appendChild(i),t},S.createOverlay=function(e,t,n,o){var i=(e||{}).content,a=((i||{}).form||{}).font,r=((i||{}).form||{}).background_image,c=((i||{}).form||{}).background_image_alt_text,s=((((e||{}).content||{}).form||{}).colours||{}).background,l=((i||{}).form||{}).title,u=(l||{}).text,d=(l||{}).fontSize,l=(l||{}).lineHeight,m=((i||{}).form||{}).content,p=(m||{}).text,f=(m||{}).fontSize,m=(m||{}).lineHeight,g=((((e||{}).content||{}).form||{}).colours||{}).content,y=((i||{}).form||{}).input_text,h=(((i||{}).form||{}).colours||{}).title,v=(((i||{}).form||{}).colours||{}).cta_background,w=(((i||{}).form||{}).colours||{}).cta_text,_=((i||{}).form||{}).cta_text,b=((i||{}).form||{}).privacy_policy_link,k=((i||{}).form||{}).privacy_policy_text,i=(((i||{}).form||{}).colours||{}).link,e=(e||{}).id,a=S.createBackdrop(a),s=S.createContentContainer(a,s,r,c),r=S.createElement("div","display: flex;flex-direction: column;width: 80%;height: 100%;align-self:center;justify-content:space-between;",s),c=S.createTopSection(r),r=S.createBottomSection(r),x=S.createCloseButton(s),h=(S.createHeader(c,h,u,d,l),S.createBody(c,g,p,4,f,m),S.createForm(r,e,y,v,w,_,o),S.createElement("div","font-size: 12px; sans-serif;text-align:center;margin-top: 18px;",r)),u=S.createElement("a","color: ".concat(i,";"),h),d=(E(u,{href:b,target:"_blank",rel:"noopener"}),document.createTextNode(k));return u.appendChild(d),document.body.appendChild(a),a.addEventListener("click",t),s.addEventListener("click",function(e){e.stopPropagation()}),x.addEventListener("click",n),a},S.createSuccessOverlay=function(e,t){var n=(e||{}).content,o=((n||{}).successMessage||{}).font,i=((n||{}).successMessage||{}).background_image,a=((n||{}).successMessage||{}).background_image_alt_text,r=((((e||{}).content||{}).successMessage||{}).colours||{}).background,c=((n||{}).successMessage||{}).title,s=(c||{}).text,l=(c||{}).fontSize,c=(c||{}).lineHeight,u=((n||{}).successMessage||{}).content,d=(u||{}).text,m=(u||{}).fontSize,u=(u||{}).lineHeight,e=((((e||{}).content||{}).successMessage||{}).colours||{}).content,n=(((n||{}).successMessage||{}).colours||{}).title,o=S.createBackdrop(o),r=S.createContentContainer(o,r,i,a),i=S.createTopSection(r,"width:80%;align-self:center;justify-content:flex-start;margin-top: 60px;"),a=(S.createElement("div","display: flex;flex-direction:column;align-items:space-between;",r),S.createCloseButton(i));return S.createHeader(i,n,s,l,c),S.createBody(i,e,d,8,m,u),document.body.appendChild(o),o.addEventListener("click",t),r.addEventListener("click",function(e){e.stopPropagation()}),a.addEventListener("click",t),o},S.createForm=function(e,t,n,o,i,a,r){var c=S.createElement("form","display:flex;justify-content:center;flex-direction:column;",e),e=(E(S.createElement("input","",c),{type:"hidden",name:"__overlay_id",value:t}),S.createElement("input","",c)),t=(E(e,{type:"hidden",name:"email",autocomplete:"off"}),S.createElement("div","display:none !important",c)),e=(E(S.createElement("input","",t),{type:"email",name:"__email",autocomplete:"off"}),S.createElement("input","",c)),t=(E(e,{type:"hidden",name:"@account",value:p.key}),S.createElement("input","",c)),e=(E(t,{type:"hidden",name:"@subscription_status",value:"SUBSCRIBED"}),S.createElement("div","display:flex;flex-direction:row; align-self: center;max-width:calc(100% - 10px);flex-wrap:wrap;width:100%;",c)),t=(E(S.createElement("input","font-size: 15px;padding:16px;height:51px;width: 230px;border-radius: 0px;border: 1px solid #C6C6C6;box-sizing: border-box;flex-grow:1;background-color:white;",e,"om_overlay_email_input"),{type:"email",name:"ue",placeholder:n}),S.createElement("button","font-size:14px;width:121px;height:51px;border:0;flex-grow:1;background-color:".concat(o,";color:").concat(i,";"),e)),n=(E(t,{type:"submit","data-testid":"om-overlays-submit"}),t.innerHTML=a,S.createElement("span","display:none;font-size:14px;color: red;padding:5px 0;flex-grow: 1;width: 300px;position: absolute;bottom: 26px; left: 0; text-align: center;",e));E(n,{id:"om-overlays-error-message","data-testid":"om-overlays-error-message"}),n.innerHTML="Please enter a valid email address",c.addEventListener("submit",function(e){e.preventDefault();var e=document.getElementById("om_overlay_email_input"),t=document.getElementById("om-overlays-error-message");if(e&&t){var n=e.value;if(t.style.display="none",!n||!/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(n).toLowerCase()))return e.style.borderColor="red",void(t.style.display="block")}for(var o=[],i=0;i<c.elements.length;++i){var a=c.elements[i];o.push(encodeURIComponent(a.name)+"="+encodeURIComponent(a.value)),"ue"===a.name&&ometria.identify(a.value)}n=o.join("&"),e=new URLSearchParams(n);return r(e),S.focusOnLoad(),!1})},S.createElement=function(e,t,n,o){e=document.createElement(e);return e.style.cssText=t,n.appendChild(e),void 0!==o&&(e.id=o),e},S.createImg=function(e,t,n,o,i,a){var r=document.createElement("img");return r.src=e,r.alt=t,r.style.cssText=n,void 0!==i&&(r.id=i),void 0!==a&&(r.tabIndex=a),o.appendChild(r),r},S.addLinkElementToHead=function(e){var t=document.head,n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.media="none",n.onload="if(media!='all')media='all'",n.href=e,t.appendChild(n)},S.googleFonts=["Baskerville","Didot","Lato","Montserrat","Open Sans","Roboto"],S.getGoogleFontsStyleSheetFromFont=function(e){return"https://fonts.googleapis.com/css2?family=".concat(e,"&display=swap")},S.addFont=function(e){S.googleFonts.includes(e)&&(e=S.getGoogleFontsStyleSheetFromFont(e),S.addLinkElementToHead(e))},S.onKeyUp=function(e){("key"in(e=e||window.event)?"Escape"===e.key||"Esc"===e.key:27===e.keyCode)&&(null!==S.overlay&&S.onOverlayBackdropClick(),null!==S.successOverlay)&&S.onSuccessOverlayCloseClick()},S.onMouseOut=function(e){!e.toElement&&!e.relatedTarget&&e.clientY<10&&S.tryToDisplayExitOverlay()},S.onTouchStart=function(){S.isOnMobile=!0,document.removeEventListener("touchstart",S.onTouchStart)},S.onScroll=function(){S.isOnMobile&&S.getScrollSpeed()<-200&&S.tryToDisplayExitOverlay()},S.getScrollSpeed=(n=0,i=t=null,function(){return e=window.scrollY,null!==t&&(n=e-t),t=e,clearTimeout(i),i=setTimeout(s,50),n}),document.addEventListener("keyup",S.onKeyUp),S.isValidUrl=function(e){var t=((window||{}).location||{}).href,n=e.filter(function(e){return"Contain"===e.select}),e=e.filter(function(e){return"Contain"!==e.select}),n=0===n.length||n.find(function(e){return t.includes(e.input)}),e=e.every(function(e){return!t.includes(e.input)});return void 0!==n&&!0===e},S.addPreConnectToHead=function(){var e=document.head,t=document.createElement("link"),n=(t.rel="preconnect",t.href="https://fonts.gstatic.com",document.createElement("link"));n.rel="preconnect",n.href="https://fonts.gstatic.com",e.appendChild(t),e.appendChild(n)},S.overlay=null,S.successOverlay=null,S.overlaySettings=null,S.isOnMobile=!1,S.main=function(){m("[!] Overlay Plugin"),S.isBrowserSupported()&&(S.addPreConnectToHead(),S.getOverlaySettings().then(S.onGetOverlaySettingsSuccess,function(e){m("Failed to get overlay settings...")}))},S.onGetOverlaySettingsSuccess=function(e){S.overlaySettings=e;var t=((S.overlaySettings||{}).overlays||[])[0],e=(((t||{}).content||{}).form||{}).font,n=(((t||{}).content||{}).successMessage||{}).font,o=((t||{}).settings||{}).status,i=(((t||{}).settings||{}).show_on_every_page,((t||{}).settings||{}).when_to_display);S.addFont(e),S.addFont(n),t?"Test"===o&&"#om_overlay_debug"!==window.location.hash&&"#om_overlays_debug"!==window.location.hash||("Entry"===i?""===(e=S.validateCanShow())?0===t.settings.display_on_entry_seconds?(S.overlay=S.createOverlay(t,S.onOverlayBackdropClick,S.onOverlayCloseClick,S.onOverlaySubmitClick),"Test"!==o&&(S.incrementNumberOfDisplays(),S.setLastDisplayedTime())):setTimeout(function(){S.overlay=S.createOverlay(t,S.onOverlayBackdropClick,S.onOverlayCloseClick,S.onOverlaySubmitClick),"Test"!==o&&(S.incrementNumberOfDisplays(),S.setLastDisplayedTime())},1e3*t.settings.display_on_entry_seconds):m(e):"Exit"===i&&(setTimeout(function(){document.addEventListener("mouseout",S.onMouseOut)},1e4),document.addEventListener("touchstart",S.onTouchStart),document.addEventListener("scroll",S.onScroll))):(m("Could not get overlay"),S.cleanup())},S.validateCanShow=function(){var e=((S.overlaySettings||{}).overlays||[])[0],t=((e||{}).settings||{}).status,n=((e||{}).settings||{}).show_on_every_page;if(Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)<320)return"Viewport is too small";if("Live"!==t&&"Test"!==t)return"Overlay not enabled!";if(!n&&!S.isValidUrl(e.settings.selected_urls))return"Not a valid URL!";if("Test"!==t){if(o)return"User is already identified";if(!0===S.getHasRejected()&&!1===e.settings.show_if_rejected)return"Ovelay already rejected!";if(null!==S.getLastDisplayedTime()&&!S.isNowGreaterThanLastDisplayedTimePlusADay())return"Already displayed one overlay in past 24h!";if(e.settings.show_overlay_multiple_times&&S.getNumberOfDisplays()>=e.settings.max_form_display)return"Displayed maximum amount of times!"}return""},S.tryToDisplayExitOverlay=function(){var e=((S.overlaySettings||{}).overlays||[])[0],t=S.validateCanShow();""===t?(S.overlay=S.createOverlay(e,S.onOverlayBackdropClick,S.onOverlayCloseClick,S.onOverlaySubmitClick),"Test"!==status&&(S.incrementNumberOfDisplays(),S.setLastDisplayedTime())):m(t)},S.onOverlayBackdropClick=function(){S.overlay.remove(),S.cleanup()},S.onOverlayCloseClick=function(){"Test"!==((((S.overlaySettings||{}).overlays||[])[0]||{}).settings||{}).status&&S.setHasRejected(),S.overlay.remove(),S.cleanup()},S.onOverlaySubmitClick=function(e){S.signup(e),S.overlay.remove(),S.successOverlay=S.createSuccessOverlay(S.overlaySettings.overlays[0],S.onSuccessOverlayCloseClick)},S.onSuccessOverlayCloseClick=function(){S.successOverlay.remove(),S.cleanup()},S.main(),S.focusOnLoad(),S}catch(e){S.cleanup(),m(e)}}function s(){t=null,n=0}}),E.push(function(){m("Shopify plugin");try{if(void 0!==window.ometria&&void 0!==window.ometria.raw_data){var e=void 0!==window.ometria.raw_data?window.ometria.raw_data:{},t={};e.namespace&&(p.namespace=e.namespace),f.site=f.site||"default",e.site&&(f.site=e.site),f.site=d(f.site);-1<I(T()).indexOf(".shopify.com")&&ometria.linkSession(!0);var n=void 0!==e.template?e.template.split("."):[];if(l("index",n)?ometria.setPageType("homepage"):l("collection",n)?(ometria.setPageType("listing"),e.collection_handle&&(t.attributes=[{id:e.collection_handle,type:"category"}]),t.category_id=d(e.collection_id||"all"),t.nitems=e.collection_count,t.page=e.current_page):l("search",n)?(ometria.setPageType("listing"),t.search=e.search_terms,t.nitems=e.search_count,t.page=e.current_page):l("cart",n)?ometria.setPageType("basket"):l("confirmation",n)?(ometria.setPageType("confirmation"),ometria.trackTransaction(d(e.order))):l("product",n)&&(ometria.setPageType("product"),e.product_id)&&(t.pid=d(e.product_id)),ometria.setPageData(t),e.cart){for(var o=new A,i=(o.setTotal(u(e.cart_total),e.shop_currency),[]),a=0;a<e.cart.length;a++){var r=e.cart[a],c="number"==typeof r[1]?r[1]:null;o.addLineItem(d(r[0]),r[2],u(r[3]),c),i.push(r[1]+":"+r[2])}var s=window.location.protocol+"//"+window.location.host+"/cart/"+i.join(",");o.url=s,ometria.setBasket(o)}if(null!==e.customer_email&&ometria.identify(e.customer_email),-1<(window.location.href+"").indexOf("checkout_url"))try{setTimeout(function(){ometria.trackCheckout("checkout")},50),ometria.setPageType("checkout")}catch(e){m(e)}if(-1<(window.location.href+"").indexOf("checkouts"))try{setTimeout(function(){ometria.trackCheckout("checkout")},50),ometria.setPageType("checkout")}catch(e){m(e)}setTimeout(function(){m("Initing default Shopify email inputs"),"function"==typeof $?($(document.body).on("submit","form[name=mc-embedded-subscribe-form]",function(){var e=$(event.target).parent().find("[type=email]").val();e&&L(e)&&ometria.identify(e)}),$(document.body).on("change","form[name=mc-form]",function(){var e=$(event.target).parent().find("[type=email]").val();e&&L(e)&&ometria.identify(e)}),$("#mc-email").on("change",function(){var e=$(event.target).val();e&&L(e)&&ometria.identify(e)}),$(document.body).on("change",'form[action="https://api.ometria.com/forms/signup"]',function(){var e=$(event.target).parent().find('[name="ue"]').val();e&&L(e)&&ometria.identify(e)}),$('input[name="checkout[email]"]').on("change",function(){var e=$(event.target).val();e&&L(e)&&ometria.identify(e)})):m("Error no jquery")},1e3)}function l(e,t){for(var n=t.length,o=0;o<n;o++)if(t[o]==e)return 1}function u(e){return null==e?null:(e=+e)/100}}catch(e){m(e)}}),S.Basket=A,S.track=function(e,t,n){R(e,t,n,"custom")},S.trackAddToBasket=function(e,t,n){t=t||1,(n=n||{}).pid=e,n.q=t,R("addtobasket",n)},S.isNewVisitor=function(){return F},S.basket=null,S.setBasket=function(e){e.lis.forEach(function(e){""===e.vi&&m("Variant ID cannot be empty string")});var t=y.get("bskt"),n=e?e.signature():"";this.basket=e,t!=n&&(y.set("bskt",n),R("setbasket",e))},S.getBasket=function(){return this.basket},S.trackCheckout=function(e,t){(t=t||{}).stage=e,R("checkout",t)},S.trackTransaction=function(e,t){(t=t||{}).tid=e,R("transaction",t),y.appendText("tids",e,"|"),f.tids=y.get("tids")},S.pageview=function(e,t,n){var o;"landing"==t&&(t="homepage"),(f.url=e)!=G&&(G=e,y.inc("npv"),f.npv=y.getInt("npv")),n.rurl=T(document.referrer),n.type=t,R("pageview",n),n=(n=t=e).slice(t.indexOf("?")+1).split("&"),o={},n.map(function(e){e=e.split("=");o[e[0]]=e[1]}),n={},(t=o).prodRecInstance&&(n.onsiteRecInstance=t.prodRecInstance),t.recommendationEngine&&(n.onsiteRecEngine=t.recommendationEngine),t.primaryEngine&&(n.onsiteRecIsPrimaryEngine="true"===t.primaryEngine),0<Object.keys(n).length&&R("rec:click",n)},S.viewProducts=function(e){},S.viewProduct=function(e){R("viewproduct",{pid:e})},S.event=function(e,t,n){},S.identify=function(e,t,n){var o,i,a,r={};(t=t||{})&&(r.profile=t),(L(r.uiid=e)||/omid:.+/.test(e))&&(a=!(i=!0),(i=(o=this.getIdentity())&&e==o?!1:i)&&o&&(a=!0),i?(f.uiid=e,a&&(c("CHANGED IDENTITY"),ne(),f.cnew=0,y.set("osrc",y.get("src")),y.set("nses",1)),R("identify",r,null),y.set("uiid",e)):t&&R("identify",r,null))},S.setProfileData=function(e){var t={};(e=e||{})&&(t.profile=e),t.uiid=ometria.getIdentity(),t.uiid&&R("profile",t,null)},S.getIdentity=function(){return y.get("uiid")||null},S.setPageType=function(e){g=e},S.setPageData=function(e){u=e},S.linkSession=function(e){f.lnk=e?"dsig":""},S.init=function(e,t,n){m("Initialize phase 1 called"),n&&(f.site=n),document.body?S.init2(e,t):setTimeout(function(){S.init(e,t)},25)},S.init2=function(e,t){m("Initialize phase 2 called"),g=e||null,u=t||{};for(var n=0;n<E.length;n++)try{m("Calling plugin: "+n),E[n](),m("Done plugin: "+n)}catch(e){m(e)}var o=T();if(p.page_types)for(n=0;n<p.page_types.length;n++){var i=p.page_types[n],a=new RegExp(i.pattern,"g");o.match(a)&&(g=i.type)}z=!0,this.pageview(o,g,u);for(var r=0;r<s.length;r++){var c=s[r];R(c[0],c[1],c[2],c[3])}"function"==typeof window.onOmetriaLoaded&&window.onOmetriaLoaded()},S._debug=function(){return{sessionId:f.sid,cookieId:f.cid,userIdentity:f.uiid,extra:f}},S._log=function(){return _log},S.observeEmailInputs=function(e){var t=document.querySelectorAll(e);for(m("Observe email input element "+t.length+" found "+e),i=0;i<t.length;++i)t[i].addEventListener("change",function(e){ometria.identify(e.target.value)})},S.setDebugLogging=function(e){D("OMdebug","1",e?1:-1),location.reload()};S.request=function(e){try{var t=e.url,n=e.body?(s=e.body,Object.keys(s).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(s[e])})):null,o=e.headers||[],i=e.method||"POST",a=e.successCallback||function(e){m(e)},r=e.errorCallback||function(e){m(e)},c=new XMLHttpRequest;c.onload=function(){try{var e=JSON.parse(c.response);200!==c.status?r(e):a&&a(e)}catch(e){r(e)}},c.onerror=function(){var e=JSON.parse(c.response);r&&r(e)},c.open(i,t),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.push({"X-Ometria-Account":p.key}),o.forEach(function(e){var t=Object.keys(e)[0];c.setRequestHeader(t,e[t])}),c.send(n)}catch(e){r(e)}var s},S.ajaxFormSubmit=function(e,o,i){e=document.querySelectorAll(e)[0];e.addEventListener("submit",function(e){e.preventDefault();var t=new XMLHttpRequest,n=e.target.elements,e=Object.keys(n).map(function(e){return encodeURIComponent(n[e].name)+"="+encodeURIComponent(n[e].value)});urlEncodedData=e.join("&").replace(/%20/g,"+"),t.onload=function(){var e=JSON.parse(t.response);o&&o(e)},t.onerror=function(){var e=JSON.parse(t.response);i&&i(e)},t.open("POST","https://api.ometria.com/forms/signup/ajax"),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(urlEncodedData)})},void 0===window.ometria&&(window.ometria={}),K(window.ometria,S),ometria.init()}}function Y(e,t){if(o||document.body&&((o=document.createElement("div")).style.border="1px solid #000",o.style.position="absolute",o.style.top="0px",o.style.right="0px",o.style.background="#666",o.style.padding="0px",o.style.color="#333",o.style.zIndex=2147483650,o.style.width="250px",o.style.maxHeight="400px",o.style.overflow="auto",document.body.appendChild(o)),o){if(a.length){for(var n=0;n<a.length;n++)J(a[n][0],a[n][1]);a=[]}J(e,t)}else a.push([e,t])}function J(e,t){try{var n=document.createElement("div");n.style.border="1px solid #000",n.style.fontSize="11px",n.style.padding="3px",n.style.margin="3px",n.style.background="#fff",n.innerHTML=""+e,t&&n.addEventListener("click",function(e){console.log(t)}),o.appendChild(n)}catch(e){}}function O(n){var e={contains:function(e){return void 0!==n[e]},get:function(e){return n[e]},set:function(e,t){n[e]=t},toObject:function(){var e,t={};for(e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t}};return e}function C(e,t){t=t||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var n="",o=0;o<e;o++){var i=Math.floor(Math.random()*t.length);n+=t.substring(i,i+1)}return n}function K(e,t){for(var n in t)e[n]=t[n]}function Z(e){var t;return"string"==typeof e?!e||(t=parseFloat(e.replace(/[^0-9\.]/g,"")),isNaN(t))?null:t:e}function V(e,t){return(e.constructor===Array?function(e,t){for(var n=[],o=0;o<e.length;o++)n[o]=t(e[o],o);return n}:function(e,t){var n,o={};for(n in e)e.hasOwnProperty(n)&&(o[n]=t(e[n],n));return o})(e,t)}function T(e){return void 0===e&&(e=window.location.href),e=(e+="").split("#")[0]}function I(e){if(!e)return null;e=e.split("/");if(e.length<3)return null;for(var t=e[2],n=0;n<p.remove_domain_prefixes.length;n++){var o=p.remove_domain_prefixes[n];0===t.indexOf(o)&&(t=t.replace(o,""))}return t=t.split(":")[0]}function L(e){return/\S+@\S+\.\S+/.test(e)}function W(e){return-1==e.indexOf("?")?O({}):X(qstr=e.substring(e.indexOf("?")+1))}function X(e){for(var t={},n=(e=(e=(e=0==e.indexOf("?")?e.substring(e.indexOf("?")+1):e).replace(/&amp;/g,"&")).replace(/\+/g,"%20")).split(/\?|&/),o=0;o<n.length;o++){var i=n[o].split("=");try{t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}catch(e){try{i[0]=i[0].replace(/%[0-9A-Z][0-9A-Z]/,""),i[1]=i[1].replace(/%[0-9A-Z][0-9A-Z]/,""),t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}catch(e){}}}return O(t)}function Q(e){var t=[];return function n(e,o,i){if(e&&"object"==typeof e){var t=e,a=function(e,t){n(t,o?o+"["+e+"]":e,i)};if(t&&t.push)for(var r=t,c=a,s=0;s<r.length;s++)c(s,r[s]);else if("object"==typeof t){var l,u=t,d=a;for(l in u)u.hasOwnProperty(l)&&d(l,u[l])}}else void 0!==e&&i.push(encodeURIComponent(o)+"="+encodeURIComponent(e))}(e,"",t),t.join("&")}function D(e,t,n,o){var i=new Date,e=e+"=2_"+encodeURIComponent(t);n&&(i.setDate(i.getDate()+n),e+=";expires="+i.toGMTString()),o&&(e+=";domain="+o),e+=";path=/",document.cookie=e}function q(e){var t=document.cookie+"";if(0<t.length){var n=t.indexOf(e+"=");if(-1!=n)return n=n+e.length+1,-1==(c_end=t.indexOf(";",n))&&(c_end=t.length),("2_"==(e=t.substring(n,c_end)).substring(0,2)?(e=e.substring(2),decodeURIComponent):unescape)(e)}return!1}function P(e,t){D(e,"",-1,t)}function M(e,t,n){this.name=e,this.saveto=null,this.changed=!1,this.life=t,this.domain=n,this.existed=!1,this.data=O({}),this.load()}function R(e,t,n,o){var i,a;o=o||"system",z?(K(i={},f),i.d=t,i.type=e,i.channel=o,N(e,t),i=l.encode(Q(i)),(a={}).data=i,a.rnd=C(6),a.enc=f.enc,i=p.endpoint+"v"+p.api_version+"/"+p.key+"/event.gif?"+Q(a),(new Image).src=i,n&&setTimeout(n,p.callback_timeout)):s.push([e,t,n,o])}function ee(e,t){e=V(function(e,t){var n=[null,null,null,null,null,null];t&&(o=I(t),!1!==(o=function(e,t){for(var n="360.cn:q|duckduckgo:q|about:terms|alice:qs|aol:q|aol:query|ask:q|avg:q|babylon:q|baidu:wd|biglobe:q|bing:q|cnn:query|comcast:q|conduit:q|daum:q|eniro:search_word|go.mail.ru:q|goo.ne:MT|google:q|images.google:q|incredimail:q|kvasir:q|live:q|lycos:q|lycos:query|mamma:q|msn:q|najdi:q|naver:query|netscape:query|onet:qt|ozu:q|pchome:q|rakuten:qt|rambler:query|search-results:q|search.centrum.cz:q|seznam:q|startsiden:q|terra:query|virgilio:qs|voila:rdata|wp:szukaj|yahoo:p|yahoo:q|yam:k|yandex:text".split("|"),o=W(t),i="."+e+".",a=0;a<n.length;a++){var r=n[a].split(":"),c="."+r[0]+".",s=r[1];if(-1<i.indexOf(c)){c=r[0];if(c=c.charAt(0).toUpperCase()+c.slice(1),o.contains(s))return[o.get(s)||null,c]}}return 0===i.indexOf(".google.")&&["NOT_SUPPLIED","Google"]}(n[0]=o,t)))&&(n[2]="search",n[1]=o[0],n[4]=o[1]);var o=W(e);o.contains("gclid")&&(n[0]||(n[0]="google.com"),n[2]="cpc",n[4]="Google");t&&-1<t.indexOf("/aclk")&&-1<t.indexOf("adurl=")&&(n[2]="cpc",n[4]="Google");o.contains("om_campaign")&&(n[2]="email",n[4]="ometria");o.contains("utm_term")&&(n[1]=o.get("utm_term"));o.contains("utm_medium")&&(n[2]=o.get("utm_medium"));o.contains("utm_campaign")&&(n[3]=o.get("utm_campaign"));o.contains("utm_source")&&(n[4]=o.get("utm_source"));o.contains("utm_content")&&(n[5]=o.get("utm_content"));return n}(e,t),function(e,t){return!0===e||!1===e||null===e?"":(e+"").replace("|","")}).join("|");return"|||||"==e?"":e+"|"+te()}function te(){var e=(new Date).getTime();return Math.floor(e/864e5)}function A(){this.lis=[],this.total=0,this.size=0,this.id=null,this.cur="",this.p={},this.url=null}function ne(){var e=C(16),e=(y.set("cid",e),f.cid=e,y.set("nses",0),Math.floor((new Date).getTime()/1e3));y.set("osts",e),f.cnew=1}}();